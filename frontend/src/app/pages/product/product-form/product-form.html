<main>
  <h2>{{ currentId() ? 'Editar' : 'Novo' }} Produto</h2>

  <form [formGroup]="form" (ngSubmit)="submit()" class="product-form">
    <div class="form-row">
      <div class="form-group">
        <label for="nameInput">Nome</label>
        <input id="nameInput" formControlName="name" />
        @if (form.get('name')?.invalid && form.get('name')?.touched) {
          <div class="error">
            Nome obrigatório
          </div>
        }
      </div>
      
      <div class="form-group">
        <label for="categorySelect">Categoria</label>
        <select id="categorySelect" formControlName="category">
          <option value="">Todas categorias</option>
          @for (cat of categories; track cat) {
            <option [value]="cat">{{ cat }}</option>
          }
        </select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="priceInput">Preço</label>
        <input id="priceInput" formControlName="price" type="number" step="0.01" />
      </div>

      <div class="form-group">
        <label for="stockInput">Estoque</label>
        <input id="stockInput" formControlName="stock" type="number" />
      </div>
    </div>

    <div class="form-group description">
      <label for="descriptionTextarea">Descrição</label>
      <textarea id="descriptionTextarea" formControlName="description"></textarea>
    </div>

    <div class="form-group">
      <label for="imageInput">Imagem</label>
      <input id="imageInput" type="file" (change)="onFileChange($event)" />
      @if (previewUrl()) {
        <div class="preview">
          <img [src]="'http://localhost:8000' + previewUrl()" />
        </div>
      }
    </div>

    <button type="button" class="btn-back" (click)="goBack()">← Voltar</button>
    <button type="submit">Salvar</button>
  </form>
</main>